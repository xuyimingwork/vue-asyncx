è®©å¼‚æ­¥åƒå†™è¯—çš„ Vue 3 ç»„åˆå¼å·¥å…·åº“ [![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/xuyimingwork/vue-asyncx) [![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/xuyimingwork/vue-asyncx)


**ä¸é‡å¤ã€æœ‰è¯­ä¹‰ï¼Œå¤©ç„¶é˜²ç«æ€ã€è‡ªç”±å¯æ‰©å±•**

![](./docs/compare-code.png)

- å®˜æ–¹æ–‡æ¡£ï¼š[Vue Asyncx](https://vue-asyncx.js.org/)
- åœ¨çº¿æ¼”ç¤ºï¼š[Playground](https://www.typescriptlang.org/play/?ts=5.9.3#code/PQKhCgAIUg3BXApgWgIYGcCeA7AxgD0kH95QCldAuT0Gj5QCH-A5uUADvQVWVAGJUFhNQIXNBIf6hgBVMAHRAGVcAJwCW-AC6QACgBtUmAOaiA9vGwATQFj-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)

## ç‰¹æ€§

- å¼‚æ­¥æ ·æ¿ä»£ç å‡å°‘ 40%+ï¼Œä¸“æ³¨ä¸šåŠ¡é€»è¾‘æœ¬èº«
- å…³è”çŠ¶æ€è‡ªåŠ¨ç”Ÿæˆå¹¶å‘½åï¼Œä»£ç ç»“æ„è‡ªè§£é‡Š
- å†…å»ºç«æ€å¤„ç†æœºåˆ¶ï¼Œé¿å…å¹¶å‘è¯·æ±‚å¯¼è‡´çš„æ•°æ®é”™ä¹±
- æ’ä»¶åŒ– addon æ¶æ„ï¼Œå¼‚æ­¥èƒ½åŠ›å¯ç»„åˆã€å¯æ‰©å±•
- SSR å‹å¥½è®¾è®¡ï¼Œæ— æµè§ˆå™¨ä¾èµ–ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œå®‰å…¨å¯æ§
- é›¶ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæ¨¡å—çº¯å‡€ï¼Œå¤©ç„¶æ”¯æŒ Tree-shaking
- å®Œæ•´çš„ TypeScript ç±»å‹è®¾è®¡ä¸æ¨å¯¼æ”¯æŒ
- 100% å•å…ƒæµ‹è¯•è¦†ç›–ï¼Œ300+ ç”¨ä¾‹ä¿éšœè¡Œä¸ºç¨³å®š

## å®‰è£…

```console
pnpm i vue-asyncx
```

## å¿«é€Ÿå¼€å§‹

### useAsyncData (å¼‚æ­¥æ•°æ®ç®¡ç†)

éœ€è¦ä½¿ç”¨å¼‚æ­¥æ•°æ® `user` æ—¶ï¼Œè°ƒç”¨ `useAsyncData` ä¼ å…¥æ•°æ®åå’Œæ•°æ®è·å–å‡½æ•°å³å¯ã€‚`useAsyncData` ä¼šè‡ªåŠ¨å¤„ç†ä¸å¼‚æ­¥å‡½æ•°ç›¸å…³çš„ `data`, `loading`, `arguments`, `error` ç­‰çŠ¶æ€ã€‚

```ts
import { getUserApi } from './api'
import { useAsyncData } from 'vue-asyncx'

const { 
  user, 
  queryUserLoading,
  queryUser, 
} = useAsyncData('user', getUserApi) // ä»£ç å³æ³¨é‡Šï¼šä½¿ç”¨å¼‚æ­¥æ•°æ® user

queryUser('Mike')
```

æ›´å¤šå†…å®¹ï¼Œè§ï¼š[useAsyncData](https://vue-asyncx.js.org/hooks/use-async-data.html)

### useAsync (å¼‚æ­¥å‡½æ•°ç®¡ç†)

å½“ä¸éœ€è¦å¼‚æ­¥æ•°æ®ï¼Œåªå…³æ³¨å¼‚æ­¥å‡½æ•°çš„æ‰§è¡ŒçŠ¶æ€æ—¶ï¼šè°ƒç”¨ `useAsync` ä¼ å…¥å‡½æ•°åå’Œå¼‚æ­¥å‡½æ•°å³å¯ã€‚`useAsync` ä¼šè‡ªåŠ¨å¤„ç†ä¸è¯¥å¼‚æ­¥å‡½æ•°ç›¸å…³çš„ `loading`, `arguments`, `error` ç­‰çŠ¶æ€ã€‚

```ts
import { submitApi } from './api'
import { useAsync } from 'vue-asyncx'

const { 
  submit, 
  submitLoading,
  submitError,
} = useAsync('submit', submitApi) // ä»£ç å³æ³¨é‡Šï¼šä½¿ç”¨å¼‚æ­¥å‡½æ•° submit

// è¡¨å•æäº¤
action="@click="submit(formData)"
```

æ›´å¤šå†…å®¹ï¼Œè§ï¼š[useAsync](https://vue-asyncx.js.org/hooks/use-async.html)

## è®¾è®¡å“²å­¦ï¼šçº¦å®šå¸¦æ¥æ•ˆç‡

ä¸ [`useRequest`](https://ahooks.js.org/hooks/use-request/index) è¿”å›å›ºå®šçš„ `data`ã€`loading`ã€`error` ä¸åŒï¼Œ`useAsyncData` å°†å…³è”çš„å‡½æ•°ã€å˜é‡ç»Ÿä¸€å‘½åï¼š

- `user`ï¼šç”±å¼‚æ­¥å‡½æ•°æ›´æ–°çš„æ•°æ® `data`
- `queryUser`ï¼šæ›´æ–° `user` çš„å¼‚æ­¥å‡½æ•°
- `queryUserLoading`ï¼šè°ƒç”¨ `queryUser` æ—¶çš„ `loading` çŠ¶æ€

åˆšæ¥è§¦å¯èƒ½æœ‰äº›ä¸ä¹ æƒ¯ï¼Œä½†è¿™ç§æ–¹å¼å¸¦æ¥å¯è¯»æ€§å’Œæ•ˆç‡çš„åŒé‡æå‡ï¼Œåœ¨å¤§å‹é¡¹ç›®ã€å¤šäººå›¢é˜Ÿä¸­å°¤ä¸ºæ˜æ˜¾ã€‚

ä»£ç ä¸­çœ‹åˆ° `queryUserLoading` å˜é‡ï¼Œå°±çŸ¥é“å®ƒå’Œ `user` å˜é‡ä»¥åŠ `queryUser` å‡½æ•°æœ‰å…³ã€‚

å¹¶ä¸”è¿™ä¸€åˆ‡ï¼Œéƒ½å¯ä»¥è‡ªåŠ¨æç¤ºã€‚

![](./docs/demo-basic.gif)


æ›´å¤šå†…å®¹ï¼Œè§ï¼š[å‘½åçº¦å®š](https://vue-asyncx.js.org/introduction.html#naming-convention)

## é«˜çº§ç”¨æ³•ç¤ºä¾‹ï¼šå¹¶è¡ŒåŒè¯­ä¹‰æ“ä½œ

åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼ŒåŒä¸€ä¸ªå¼‚æ­¥æ“ä½œå¯èƒ½éœ€è¦åˆ†ç»„**å¹¶è¡Œå¤šæ¬¡è°ƒç”¨**ï¼ˆä¾‹å¦‚åˆ—è¡¨ä¸­å¤šä¸ªæŒ‰é’®è§¦å‘åŒä¸€æ“ä½œï¼‰ã€‚

`vue-asyncx` é€šè¿‡ `withAddonGroup` æ’ä»¶æä¾›æ”¯æŒ

![](./docs/demo-addon-group.gif)

ğŸ‘‰ é€‚ç”¨äºï¼šåˆ—è¡¨æ“ä½œ / æ‰¹é‡æ“ä½œ / å¤šå®ä¾‹å¼‚æ­¥

```ts
const { 
  confirm, 
  confirmGroup 
} = useAsync('confirm', confirmApi, {
  addons: [
    withAddonGroup({
      key: (args) => args[0], // ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºåˆ†ç»„ key
    }),
  ],
})
```

è¯¦ç»†å†…å®¹ï¼Œè§ï¼š[withAddonGroup](https://vue-asyncx.js.org/addons/group.html)

## å…¼å®¹æ€§

- å®Œæ•´ç±»å‹æç¤ºéœ€è¦ TS >= 5.4ï¼›éæ’ä»¶åŠŸèƒ½ç±»å‹å…¼å®¹è‡³ TS >= v4.1 
- æ”¯æŒ Vue 3.x / Vue 2.7